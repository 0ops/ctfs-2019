#!/usr/local/bin/sage

from sage.all import *
from secret import *

print '(A_1, B_1) =', (A_1, B_1)
print '(A_2, B_2) =', (A_2, B_2)

E_1 = EllipticCurve(Zmod(n_1), [A_1, B_1])
E_2 = EllipticCurve(Zmod(n_2), [A_2, B_2])

d_1 = int(flag[:len(flag)/2].encode('hex'), 16)
d_2 = int(flag[len(flag)/2:].encode('hex'), 16)

assert d_1 < n_1 and d_2 < n_2 and n_1 * n_2 % 2 == 1

print 'P_1 =', P_1
print 'P_2 =', P_2

Q_1 = d_1 * P_1
Q_2 = d_2 * P_2

print 'Q_1 =', Q_1
print 'Q_2 =', Q_2

# (A_1, B_1) = (4100133310575364011719743521079184461074386086908714625945625015559982177755652249240883318459158099254673716037393799806563567496713759930310260790170700L, 1122736575135956550498512579475613266532272320672056044481173789518413402619422268998022672611181357437113262000853974968410911833838413926464792002813447L)
# (A_2, B_2) = (7195356291935324092974083800656294719909791991638016800688869531480914420851344517648017858841138300709252000726562477192528094479414307745557474907942803L, 6294820679829743993553990213393473947712658480308258869413745721454083757402985469790896377224901851178278372055326475131634987824882821588180629785125494L)
# P_1 = (2020 : 1541289077285950476559411104738671299410620709860226880193167593009859736744811748999762048127883283085467497522757803253784396241175263384974343969389613 : 1)
# P_2 = (2019 : 4974488224848659884031032545639754297422048908695379071395934742158247177808858717918207312066922185990894913147917789468490894652686551750625949315572060 : 1)
# Q_1 = (618557765800750819209991316860882839555616891049138511957097251334207165235365069009990394212384430641656483864543452461074647961570036980133121226790676 : 1912192017248939370370171524353367472317941092660336078617752789285987994955919216772863103147273102025883679405387407568801952770276812434793253510856342 : 1)
# Q_2 = (3498315230862051726722937542044146709141760804952759034107762377825674224891256652411838536715783050883855279807866167028753678099833796125634334124551556 : 1700134660303914635540188684404266565369868807277098991690614159152164658899818711426168666271084645702085789685102435043642173628403538966759243249623606 : 1)