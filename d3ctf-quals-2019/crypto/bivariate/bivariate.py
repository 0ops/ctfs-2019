from Crypto.Util import number
from secret import flag


nbit = 2048
e = 65537
p, q = number.getPrime(nbit//2), number.getPrime(nbit//2)
N = p * q
# N = 29645777419353736043057269010272359991416746014481631913846394670078485669726163429148261773650808178885540922407769261977694870685655675641674238423494302502713669170229824386613320560323567408297922627498904721032641809270387608763375110868803588215842220559925272939588535929617335141314939188135485819647392547941664721198106918867256215010691258972314587355422307935800963252186373953902703756486263607531802422220243261067840601049386548437700448106992244972092205487949271972315893678254707578275422023764563404729727966134925789323455747715178318199560676511490769844114918905097088133071853897724375466871753
l1, l2 = 100, 100
p0 = p&(2**(nbit//2-l2)-2**l1)
# p0 = 19994706539344817615577001340218084154374248082066669466133143688464179834710257290336770530283220217475114036198814696889289562075455713159534426021509764445583402971591173189115806435513627099657084735309947492280373743846773519959600992501216048618966605151951399747378479104
m = number.bytes_to_long(flag)
c = pow(m, e, N)
# c = 7694028696447203055167399614781742755233053501626948191487643786599831140635293828884780055356284626663129451347502647051088048380199347483536968808813587826859620049775396873717297332186322514747353165132000670895060078379130985428951115709881435036017128132729124851968540263457421976158921742081845963927952802266087877892966035363073622017314606731162063764705983433839542946381332691603550403398970180516625310081042782432877464770353770090161091698648807139629607359568734465463219577161798805093345331883850704725036104900961175566402889261422944217295065701981664028001963430622802457144426613143149027199687
